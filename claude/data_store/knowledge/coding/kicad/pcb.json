{
  "document_type": "kicad_pcb_structure_reference",
  "document_version": "1.0.0",
  "parser_framework": "kiutils",
  "core_objects": {
    "board": {
      "description": "Main container for all PCB data",
      "access_method": "Board.from_file(path)",
      "key_attributes": [
        "footprints",
        "tracks", 
        "vias",
        "nets",
        "layers",
        "zones"
      ]
    },
    "footprints": {
      "description": "Components on the PCB",
      "type": "List of Footprint objects",
      "properties": {
        "reference": {
          "extraction": "from properties where key='Reference'",
          "location": "footprint.properties"
        },
        "position": {
          "x_coordinate": "footprint.position.X",
          "y_coordinate": "footprint.position.Y"
        },
        "rotation": "footprint.position.angle",
        "library": {
          "reference": "footprint.libraryReference",
          "entry_name": "footprint.entryName"
        },
        "side": "determined by layer placement"
      }
    },
    "layers": {
      "description": "Physical layer stackup",
      "types": [
        "signal",
        "power",
        "ground",
        "mechanical",
        "silkscreen"
      ],
      "properties": {
        "ordinal": "layer order number",
        "canonical_name": "internal layer name",
        "type": "layer type designation",
        "user_name": "user-defined name"
      },
      "access": "board.layers"
    },
    "nets": {
      "description": "Electrical connectivity networks",
      "properties": {
        "number": "unique ID",
        "name": "user-defined name"
      },
      "usage": "referenced by tracks, vias, and pads"
    },
    "tracks_and_vias": {
      "tracks": {
        "description": "Copper routing between components",
        "properties": [
          "width",
          "layer",
          "net assignment"
        ]
      },
      "vias": {
        "description": "Layer-to-layer connections", 
        "properties": [
          "width",
          "layer",
          "net assignment"
        ]
      },
      "connectivity": "link footprint pads through nets"
    }
  },
  "coordinate_system": {
    "units": "millimeters (mm)",
    "origin": "bottom-left corner of board outline",
    "y_axis": "increases upward (opposite to screen coordinates)"
  },
  "analysis_functions": {
    "footprint_analysis": {
      "function_name": "analyze_footprints",
      "parameters": ["board"],
      "returns": "footprint_data array",
      "extracted_data": [
        "reference designator",
        "library information",
        "position and rotation"
      ],
      "implementation": {
        "reference_extraction": "iterate through footprint.properties for key='Reference'",
        "library_info": "footprint.libraryReference and footprint.entryName",
        "position": "footprint.position.X, footprint.position.Y",
        "rotation": "footprint.position.angle"
      }
    },
    "layer_stack_analysis": {
      "function_name": "analyze_layers",
      "parameters": ["board"],
      "returns": "sorted layer array by ordinal",
      "extracted_data": [
        "ordinal",
        "canonical name",
        "type",
        "user name"
      ]
    },
    "net_connectivity": {
      "function_name": "analyze_nets",
      "parameters": ["board"],
      "returns": "nets array with counts",
      "extracted_data": [
        "net number",
        "net name", 
        "track count",
        "via count"
      ]
    }
  },
  "json_data_structure": {
    "complete_pcb_format": {
      "metadata": {
        "converter_version": "string",
        "source_file": "string", 
        "kicad_version": "integer",
        "generator": "string"
      },
      "computed_info": {
        "layer_count": "integer",
        "footprint_count": "integer",
        "track_count": "integer",
        "via_count": "integer",
        "net_count": "integer",
        "footprint_types": "object mapping library:footprint_name to count",
        "footprint_positions": {
          "type": "array",
          "items": {
            "reference": "string",
            "library_reference": "string",
            "entry_name": "string",
            "x": "float",
            "y": "float",
            "rotation": "float",
            "side": "string"
          }
        },
        "component_references": "sorted array of reference strings",
        "nets": {
          "type": "array",
          "items": {
            "number": "integer",
            "name": "string"
          }
        },
        "layers": {
          "type": "array", 
          "items": {
            "ordinal": "integer",
            "canonical_name": "string",
            "type": "string",
            "user_name": "string"
          }
        }
      }
    }
  },
  "parsing_patterns": {
    "loading_pcb_data": {
      "function": "load_pcb_data",
      "path_pattern": "claude/data_store/pcb/{project_name}/complete_project/{project_name}.json",
      "encoding": "utf-8"
    },
    "component_extraction": {
      "positions": "get_component_positions",
      "types": "get_component_types", 
      "returns": "sorted components by reference"
    },
    "net_analysis": {
      "function": "analyze_pcb_nets",
      "categorizes": [
        "total_nets",
        "named_nets",
        "unnamed_nets", 
        "power_nets",
        "signal_nets"
      ],
      "power_keywords": ["VCC", "VDD", "GND", "+", "-"]
    },
    "layer_stack": {
      "function": "get_layer_stack",
      "categories": {
        "signal_layers": "type='signal'",
        "plane_layers": "type in ['power', 'mixed']", 
        "mechanical_layers": "name contains 'mechanical'",
        "other_layers": "all remaining types"
      }
    }
  },
  "advanced_features": {
    "footprint_dimensions": {
      "function": "extract_footprint_dimensions",
      "extracts": [
        "pad information",
        "physical dimensions",
        "courtyard data"
      ],
      "pad_properties": [
        "number",
        "type",
        "shape",
        "position",
        "size",
        "drill",
        "layers",
        "net"
      ]
    },
    "component_pin_mapping": {
      "function": "get_component_pin_mapping",
      "creates_mapping": "components to pin layouts",
      "includes": [
        "pin numbers",
        "relative positions",
        "absolute positions",
        "net assignments"
      ]
    },
    "footprint_shapes": {
      "function": "extract_footprint_shapes",
      "categories": {
        "silkscreen": ["F.SilkS", "B.SilkS"],
        "fabrication": ["F.Fab", "B.Fab"],
        "courtyard": ["F.CrtYd", "B.CrtYd"],
        "assembly": ["User layers", "Dwgs layers"],
        "other": "remaining layers"
      },
      "geometric_types": [
        "FpLine",
        "FpRect", 
        "FpCircle",
        "FpArc",
        "FpPoly",
        "FpText"
      ]
    },
    "board_outline": {
      "function": "get_board_outline_dimensions",
      "layer": "Edge.Cuts",
      "supported_types": [
        "GrLine",
        "GrArc"
      ],
      "calculates": [
        "width",
        "height", 
        "bounding box",
        "edge segment count"
      ]
    }
  },
  "visualization_support": {
    "data_preparation": {
      "function": "prepare_visualization_data",
      "output_format": {
        "nodes": "component positions and properties",
        "board_bounds": "min/max x/y coordinates"
      },
      "compatible_with": [
        "D3.js",
        "Three.js",
        "other visualization libraries"
      ]
    },
    "component_visual": {
      "function": "get_component_visual_representation",
      "includes": [
        "transformed shapes",
        "pad layouts",
        "overall bounds"
      ],
      "coordinate_transformation": "footprint to board coordinates"
    }
  },
  "integration_patterns": {
    "pcb_visualization": [
      "component placement using footprint positions",
      "net highlighting with color coding",
      "layer visualization with opacity/color",
      "3D representation using dimensions"
    ],
    "cross_reference_schematic": [
      "reference matching between PCB and schematic",
      "net correlation verification", 
      "component validation"
    ],
    "manufacturing_data": [
      "pick and place export",
      "BOM generation",
      "assembly drawings",
      "drill files"
    ]
  },
  "common_pitfalls": [
    "PCB Y-axis increases upward, different from screen coordinates",
    "Layer ordinal numbers may not be sequential",
    "References stored in properties, not direct attributes", 
    "Net numbers vs names can be inconsistent",
    "Footprint libraries may reference external files"
  ],
  "file_organization": {
    "structure": "claude/data_store/pcb/project_name/complete_project/ProjectName.json",
    "includes": [
      "project_info.json",
      "kicad_pcb_knowledge.md"
    ],
    "supports": "multiple PCB projects with comprehensive analysis"
  },
  "utility_functions": {
    "safe_navigation": {
      "function": "navigate_pcb_json",
      "returns": {
        "metadata": "file source and version info",
        "computed": "processed analysis data", 
        "raw": "kiutils data for advanced processing"
      }
    },
    "safe_access": {
      "function": "safe_json_access",
      "path_format": "dot notation like 'computed_info.nets.0.name'",
      "handles": "missing keys and array indices gracefully"
    },
    "validation": {
      "function": "validate_pcb_json",
      "checks": [
        "required structure sections",
        "computed data consistency", 
        "coordinate validity",
        "reference completeness"
      ],
      "returns": {
        "valid": "boolean",
        "errors": "critical issues array",
        "warnings": "non-critical issues array"
      }
    }
  },
  "analysis_categories": {
    "statistics": {
      "overview": [
        "total_components",
        "total_nets",
        "layer_count",
        "track_count", 
        "via_count"
      ],
      "breakdowns": [
        "component_breakdown by type",
        "type_percentages",
        "reference list"
      ]
    },
    "size_analysis": {
      "footprint_sizes": "width, height, area calculations",
      "pin_count_distribution": "pin count statistics",
      "largest_smallest": "sorted by area"
    },
    "shape_complexity": {
      "geometric_elements": [
        "lines",
        "rectangles", 
        "circles",
        "arcs",
        "polygons",
        "text"
      ],
      "complexity_categories": [
        "simple (<=4 elements)",
        "moderate (5-12 elements)",
        "complex (>12 elements)"
      ]
    }
  }
}